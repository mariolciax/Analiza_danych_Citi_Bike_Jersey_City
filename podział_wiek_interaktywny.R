library("dplyr")
library("plotly")
library("RColorBrewer")
library("rCharts")
options(repr.plot.width = 7)
options(repr.plot.height = 5)
options(jupyter.rich_display = FALSE)
options(width = 120)

marzec20_JC<-read.csv("JC-202003-citibike-tripdata.csv")
marzec19_JC<-read.csv("JC-201903-citibike-tripdata.csv")
marzec18_JC<-read.csv("JC-201803-citibike-tripdata.csv")
m18<-mutate(marzec18_JC, birth.year=2018-birth.year)
m18<-group_by(m18,birth.year)
m18<-tally(m18)
m18<-rename(m18,marzec_2018=n)
m19<-mutate(marzec19_JC, birth.year=2019-birth.year)
m19<-group_by(m19,birth.year)
m19<-tally(m19)
m19<-rename(m19,marzec_2019=n)
m20<-mutate(marzec20_JC, birth.year=2020-birth.year)
m20<-group_by(m20, birth.year)
m20<-tally(m20)
m20<-rename(m20,marzec_2020=n)
t<-full_join(m19,m20,by=c("birth.year"="birth.year"))
t<-full_join(m18,t,by=c("birth.year"="birth.year"))
t<-mutate(t,marzec_2018=ifelse(is.na(marzec_2018),0,marzec_2018))
t<-mutate(t,marzec_2019=ifelse(is.na(marzec_2019),0,marzec_2019))
t<-mutate(t,marzec_2020=ifelse(is.na(marzec_2020),0,marzec_2020))
t<-rename(t,rok_urodzenia=birth.year)
t<-arrange(t,rok_urodzenia)


m1<-mPlot(x="rok_urodzenia",y=c("marzec_2018","marzec_2019","marzec_2020"),type="Line",
          data=t,pointSize=0, lineWidth=2)
m1
